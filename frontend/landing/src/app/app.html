<div class="page-wrapper">
  <div class="decor decor-1"></div>
  <div class="decor decor-2"></div>
  <div class="decor decor-3"></div>

  <header class="page-header">
    <div class="brand">
      <img src="assets/images/bisoyle-logo.png" alt="De'Bakiim Logo">
      <div>
        <span class="brand-title">De'Bakiim</span>
        <span class="brand-tagline">Sesli SipariÅŸ &amp; Abonelik Platformu</span>
      </div>
    </div>
    <nav class="header-actions">
      <a class="header-link" href="#plans">Planlar</a>
      <a class="header-link" href="#features">Ã–zellikler</a>
      <a class="cta-button" href="#plans">Hemen BaÅŸla</a>
    </nav>
  </header>

  <main>
    <section class="hero">
      <div class="hero-content">
        <p class="pill">Yeni KuÅŸak Sesli SatÄ±ÅŸ Platformu</p>
        <h1>De'Bakiim ile aboneliÄŸinizi dakikalar iÃ§inde baÅŸlatÄ±n</h1>
        <p class="hero-lead">
          De'Bakiim; Ã§ok kanallÄ± sesli sipariÅŸ, lisans yÃ¶netimi ve cihaz aktivasyonu iÃ§in uÃ§tan uca
          Ã§Ã¶zÃ¼mler sunar. Landing sayfamÄ±z Ã¼zerinden aboneliÄŸinizi satÄ±n alÄ±n, firmanÄ±zÄ± oluÅŸturun
          ve lisans anahtarÄ±nÄ±zÄ± anÄ±nda teslim alÄ±n.
        </p>
        <div class="hero-cta">
          <a class="primary-button" href="#plans">
            <i>ğŸš€</i> PlanlarÄ± Ä°ncele
          </a>
          <button class="secondary-button" type="button" (click)="goBack(1)">
            <i>ğŸ¬</i> Demo Ã–nizlemesini GÃ¶r
          </button>
        </div>
        <div class="hero-meta">
          <div>
            <strong>%99.9</strong>
            <span>SLA garantisi</span>
          </div>
          <div>
            <strong>+250</strong>
            <span>Aktif bayi</span>
          </div>
          <div>
            <strong>7/24</strong>
            <span>Destek merkezi</span>
          </div>
        </div>
        <div class="hero-metrics">
          <div class="metric-card">
            <span class="metric-icon">ğŸ”</span>
            <div>
              <strong>Birlikte Gelen Lisans</strong>
              <p>Her abonelikte cihaz lisanslarÄ± otomatik hazÄ±rlanÄ±r.</p>
            </div>
          </div>
          <div class="metric-card">
            <span class="metric-icon">ğŸ¤–</span>
            <div>
              <strong>Yapay ZekÃ¢ Destekli</strong>
              <p>Ses tanÄ±ma motoru ile hÄ±zlÄ± ve hatasÄ±z sipariÅŸ.</p>
            </div>
          </div>
          <div class="metric-card">
            <span class="metric-icon">ğŸ“ˆ</span>
            <div>
              <strong>CanlÄ± Analitik</strong>
              <p>GerÃ§ek zamanlÄ± raporlar ve cihaz aktivasyon takibi.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="hero-visual-glow"></div>
        <img src="assets/images/photo.png" alt="De'Bakiim ana ekran Ã¶n izlemesi">
      </div>
    </section>

    <section class="features" id="features">
      <div class="section-header">
        <div>
          <h2 class="section-title">Neden De'Bakiim?</h2>
          <p class="section-subtitle">Tek platformla hem abonelik satÄ±n alÄ±n hem de operasyonlarÄ±nÄ±zÄ± dakikalar iÃ§inde ayaÄŸa kaldÄ±rÄ±n.</p>
        </div>
      </div>
      <div class="features-grid">
        <article class="feature-card">
          <span class="feature-icon">âš¡</span>
          <h3>AnÄ±nda Aktivasyon</h3>
          <p>Ã–deme sonrasÄ± firma kaydÄ±, lisans anahtarÄ± ve admin kullanÄ±cÄ± otomatik oluÅŸturulur.</p>
        </article>
        <article class="feature-card">
          <span class="feature-icon">ğŸŒ</span>
          <h3>Ã‡oklu Kanal DesteÄŸi</h3>
          <p>Sesli, mobil ve kiosk sipariÅŸler tek panelden yÃ¶netilir, cihaz kotalarÄ± planÄ±nÄ±za gÃ¶re tanÄ±mlanÄ±r.</p>
        </article>
        <article class="feature-card">
          <span class="feature-icon">ğŸ§ </span>
          <h3>AkÄ±llÄ± Kontroller</h3>
          <p>Lisans muhafÄ±zlarÄ±, cihaz parmak izi eÅŸleÅŸtirme ve tolerans yÃ¶netimiyle gÃ¼venli kurulum.</p>
        </article>
        <article class="feature-card">
          <span class="feature-icon">ğŸ¤</span>
          <h3>PaydaÅŸ OdaklÄ±</h3>
          <p>Bayiler, iÅŸletmeler ve Ã§alÄ±ÅŸanlar iÃ§in Ã¶zelleÅŸtirilmiÅŸ arayÃ¼zler, rol bazlÄ± yetkilendirme.</p>
        </article>
      </div>
    </section>

    <section class="progress-section" aria-label="KayÄ±t adÄ±mlarÄ±">
      <h2 class="section-title">AdÄ±m adÄ±m abonelik akÄ±ÅŸÄ±</h2>
      <div class="steps">
        @for (step of steps; track step.id) {
          <div class="step" [class.active]="currentStep() === step.id" [class.completed]="currentStep() > step.id">
            <span class="step-index">{{ step.id }}</span>
            <div class="step-body">
              <span class="step-title">{{ step.title }}</span>
              <span class="step-description">{{ step.description }}</span>
            </div>
          </div>
        }
      </div>
    </section>

    <section id="plans" class="card-section" aria-label="Abonelik planlarÄ±">
      <div class="section-header">
        <div>
          <h2 class="section-title">PlanÄ±nÄ±zÄ± seÃ§in</h2>
          <p class="section-subtitle">SektÃ¶rÃ¼nÃ¼z ve ekip bÃ¼yÃ¼klÃ¼ÄŸÃ¼nÃ¼z ne olursa olsun, De'Bakiim ile dakikalar iÃ§inde aktif olun.</p>
        </div>
        <button class="link-button" type="button" (click)="resetFlow(true)" *ngIf="selectedPlan()">Plan seÃ§imini sÄ±fÄ±rla</button>
      </div>

      @if (plansLoading()) {
        <div class="skeleton-grid">
          @for (index of [0,1,2]; track index) {
            <div class="skeleton-card"></div>
          }
        </div>
      } @else if (plansError()) {
        <div class="error-state">
          <strong>Planlar yÃ¼klenemedi.</strong>
          <p>{{ plansError() }}</p>
          <button class="secondary-button" type="button" (click)="loadPlans()">Tekrar dene</button>
        </div>
      } @else if (!licensesAvailable()) {
        <div class="empty-state">
          <strong>Åu an satÄ±ÅŸa aÃ§Ä±k plan bulunmuyor.</strong>
          <p>LÃ¼tfen kÄ±sa sÃ¼re sonra tekrar kontrol edin veya destek ekibimizle iletiÅŸime geÃ§in.</p>
        </div>
      } @else {
        <div class="plan-grid">
          @for (plan of plans(); track plan.id) {
            <article class="plan-card" [class.selected]="selectedPlan()?.id === plan.id">
              <header>
                <div class="plan-heading">
                  <h3>{{ plan.planAdi }}</h3>
                  <span class="plan-price">{{ formatPrice(plan.aylikUcret) }} <small>/ ay</small></span>
                </div>
                <p class="plan-meta">
                  {{ plan.maxKullaniciSayisi }} kullanÄ±cÄ± â€¢ {{ plan.maxBayiSayisi }} cihaz lisansÄ±
                </p>
              </header>
              <ul class="plan-features">
                <li>Tenant baÅŸÄ±na Ã¶zel lisans anahtarÄ±</li>
                <li>GerÃ§ek zamanlÄ± cihaz aktivasyon takibi</li>
                <li>Ses tanÄ±ma modÃ¼lÃ¼ entegrasyonu</li>
                <li>Rol bazlÄ± yetkilendirme</li>
              </ul>
              <button class="primary-button" type="button" (click)="selectPlan(plan)">
                @if (selectedPlan()?.id === plan.id) {
                  <span>Bu plan seÃ§ildi</span>
                } @else {
                  <span>PlanÄ± seÃ§</span>
                }
              </button>
            </article>
          }
        </div>
      }
    </section>

    @if (currentStep() >= 2) {
      <section class="card-section" id="company" aria-label="Firma bilgileri">
        <div class="section-header">
          <div>
            <h2 class="section-title">Firma bilgilerinizi girin</h2>
            <p class="section-subtitle">Bu bilgiler De'Bakiim Ã¼zerinde tenant kaydÄ± oluÅŸturmak iÃ§in kullanÄ±lacaktÄ±r.</p>
          </div>
          @if (currentStep() > 2) {
            <button class="link-button" type="button" (click)="goBack(2)">Bilgileri dÃ¼zenle</button>
          }
        </div>

        <form [formGroup]="companyForm" class="form-grid" (ngSubmit)="submitCompanyForm()">
          <div class="form-field">
            <label for="firmaAdi">Firma AdÄ± *</label>
            <input id="firmaAdi" type="text" formControlName="firmaAdi" placeholder="Ã–rn. Hosteagle Teknoloji">
            <small class="error" *ngIf="companyForm.get('firmaAdi')?.invalid && companyForm.get('firmaAdi')?.touched">
              Firma adÄ± en az 3 karakter olmalÄ±.
            </small>
          </div>
          <div class="form-field">
            <label for="email">E-posta *</label>
            <input id="email" type="email" formControlName="email" placeholder="info@firma.com">
            <small class="error" *ngIf="companyForm.get('email')?.invalid && companyForm.get('email')?.touched">
              GeÃ§erli bir e-posta adresi girin.
            </small>
          </div>
          <div class="form-field">
            <label for="telefon">Telefon</label>
            <input id="telefon" type="tel" formControlName="telefon" placeholder="0 212 000 00 00">
          </div>
          <div class="form-field">
            <label for="vergiNo">Vergi NumarasÄ±</label>
            <input id="vergiNo" type="text" formControlName="vergiNo" placeholder="1234567890">
          </div>
          <div class="form-field form-field--full">
            <label for="adres">Adres</label>
            <textarea id="adres" rows="3" formControlName="adres" placeholder="Vergi dairesi, adres ve diÄŸer bilgiler"></textarea>
          </div>

          @if (createTenantError()) {
            <div class="alert alert-error form-field--full">
              {{ createTenantError() }}
            </div>
          }

          <div class="form-actions">
            <button class="secondary-button" type="button" (click)="goBack(1)">Geri dÃ¶n</button>
            <button class="primary-button" type="submit" [disabled]="createTenantLoading()">
              @if (createTenantLoading()) {
                <span class="spinner"></span>
                Ä°ÅŸleniyor...
              } @else {
                <span>Kaydet ve Ã¶deme adÄ±mÄ±na geÃ§</span>
              }
            </button>
          </div>
        </form>
      </section>
    }

    @if (currentStep() >= 3) {
      <section class="card-section" id="payment" aria-label="Ã–deme">
        <div class="section-header">
          <div>
            <h2 class="section-title">Ã–deme bilgileri</h2>
            <p class="section-subtitle">
              Sanal POS altyapÄ±mÄ±z Ã¼zerinden kartÄ±nÄ±zÄ± gÃ¼venle kullanabilirsiniz. Tutar, plan seÃ§iminize gÃ¶re hesaplanÄ±r.
            </p>
          </div>
          <button class="link-button" type="button" (click)="goBack(2)">Firma bilgilerine dÃ¶n</button>
        </div>

        <div class="payment-summary">
          <div>
            <span class="summary-label">SeÃ§ilen plan</span>
            <strong>{{ selectedPlan()?.planAdi }}</strong>
          </div>
          <div>
            <span class="summary-label">Tutar</span>
            <strong>{{ formatPrice(selectedPlan()?.aylikUcret ?? 0) }}</strong>
          </div>
          <div>
            <span class="summary-label">Desteklenen bankalar</span>
            <span class="summary-detail">
              @if (bankList().length) {
                {{ bankList().join(', ') }}
              } @else {
                TÃ¼m yerel bankalar
              }
            </span>
          </div>
          <div class="payment-accepted-cards">
            <span class="summary-label">Kabul Edilen Kartlar</span>
            <div class="card-logos">
              <img src="assets/images/visa-logo.svg" alt="Visa" class="card-logo" onerror="this.style.display='none'">
              <img src="assets/images/mastercard-logo.svg" alt="MasterCard" class="card-logo" onerror="this.style.display='none'">
            </div>
          </div>
          <div class="payment-gateway">
            <span class="summary-label">Ã–deme AltyapÄ±sÄ±</span>
            <div class="iyzico-badge">
              <img src="assets/images/iyzico-logo.svg" alt="iyzico ile Ã–de" class="iyzico-badge-img" onerror="this.style.display='none'">
            </div>
          </div>
          @if (paymentSettings()) {
            <div>
              <span class="summary-label">Ã–deme IBAN</span>
              <span class="summary-detail">
                <strong>{{ paymentSettings()?.iban }}</strong>
                @if (paymentSettings()?.bankName) {
                  <div>{{ paymentSettings()?.bankName }}</div>
                }
                @if (paymentSettings()?.accountHolder) {
                  <div class="text-muted">Hesap sahibi: {{ paymentSettings()?.accountHolder }}</div>
                }
              </span>
            </div>
          }
        </div>

        <div class="payment-layout">
          <div class="card-preview" [class.card-preview--back]="cardSide() === 'back'">
            <div class="card-face card-face--front">
              <div class="card-chip"></div>
              <div class="card-brand">
                @switch (cardPreview().brand) {
                  @case ('visa') { <span class="brand badge-visa">VISA</span> }
                  @case ('mastercard') { <span class="brand badge-mastercard"><span></span><span></span><strong>Mastercard</strong></span> }
                  @case ('troy') { <span class="brand badge-troy">troy</span> }
                  @case ('amex') { <span class="brand badge-amex">AMEX</span> }
                  @default { <span class="brand badge-generic">CARD</span> }
                }
              </div>
              <div class="card-number">{{ cardPreview().number }}</div>
              <div class="card-footer">
                <div class="card-holder">
                  <span>Kart Sahibi</span>
                  <strong>{{ cardPreview().holder }}</strong>
                </div>
                <div class="card-expiry">
                  <span>Son Kullanma</span>
                  <strong>{{ cardPreview().expiry }}</strong>
                </div>
              </div>
            </div>
            <div class="card-face card-face--back">
              <div class="card-strip"></div>
              <div class="card-signature">
                <span>CVV</span>
                <div class="card-cvv">{{ cardPreview().cvv }}</div>
              </div>
            </div>
          </div>

          <form [formGroup]="paymentForm" class="form-grid payment-form" (ngSubmit)="submitPaymentForm()">
            <div class="form-field form-field--full">
              <label for="cardHolder">Kart Sahibi *</label>
              <input id="cardHolder" type="text" formControlName="cardHolder" placeholder="Kart Ã¼zerindeki isim" (focus)="onCvvFocus(false)">
            </div>
            <div class="form-field form-field--full">
              <label for="cardNumber">Kart NumarasÄ± *</label>
              <input id="cardNumber" type="text" formControlName="cardNumber" placeholder="0000 0000 0000 0000" (focus)="onCvvFocus(false)">
            </div>
            <div class="form-field">
              <label for="expiryMonth">Ay *</label>
              <input id="expiryMonth" type="text" formControlName="expiryMonth" placeholder="MM" (focus)="onCvvFocus(false)">
            </div>
            <div class="form-field">
              <label for="expiryYear">YÄ±l *</label>
              <input id="expiryYear" type="text" formControlName="expiryYear" placeholder="YY" (focus)="onCvvFocus(false)">
            </div>
            <div class="form-field">
              <label for="cvv">CVV *</label>
              <input id="cvv"
                     type="password"
                     formControlName="cvv"
                     placeholder="***"
                     (focus)="onCvvFocus(true)"
                     (blur)="onCvvFocus(false)">
            </div>
            <div class="form-field">
              <label for="installment">Taksit</label>
              <select id="installment" formControlName="installment" (focus)="onCvvFocus(false)">
                @for (installment of installments(); track installment) {
                  <option [value]="installment">{{ installment }} taksit</option>
                }
              </select>
            </div>

            @if (paymentError()) {
              <div class="alert alert-error form-field--full">
                {{ paymentError() }}
              </div>
            }

            <div class="form-actions">
              <button class="secondary-button" type="button" (click)="goBack(2)">Geri dÃ¶n</button>
              <button class="primary-button" type="submit" [disabled]="paymentLoading()">
                @if (paymentLoading()) {
                  <span class="spinner"></span>
                  Ã–deme alÄ±nÄ±yor...
                } @else {
                  <span>Ã–demeyi tamamla</span>
                }
              </button>
            </div>
          </form>
        </div>

        @if (paymentResponse()) {
          <div class="alert alert-success payment-result">
            <div>
              <strong>Ã–deme baÅŸarÄ±lÄ±!</strong>
              <p>BankanÄ±z: {{ paymentResponse()?.bankName ?? 'Belirleniyor' }} â€¢ Taksit: {{ paymentResponse()?.installment }}</p>
            </div>
            <div class="reference">
              <span>Referans:</span>
              <code>{{ paymentResponse()?.reference }}</code>
            </div>
          </div>
        }

        @if (subscriptionError()) {
          <div class="alert alert-error">
            {{ subscriptionError() }}
          </div>
        }
      </section>
    }

    @if (currentStep() === 4) {
      <section class="card-section success-section" aria-label="Kurulum tamamlandÄ±">
        <div class="section-header">
          <div>
            <h2 class="section-title">HazÄ±rsÄ±nÄ±z!</h2>
            <p class="section-subtitle">De'Bakiim hesabÄ±nÄ±z baÅŸarÄ±yla oluÅŸturuldu. GiriÅŸ bilgilerinizi ve lisans anahtarÄ±nÄ±zÄ± aÅŸaÄŸÄ±da bulabilirsiniz.</p>
          </div>
          <button class="link-button" type="button" (click)="resetFlow(true)">Yeni bir firma ekle</button>
        </div>

        <div class="success-summary">
          <div class="success-icon">ğŸ“¬</div>
          <div>
            <h3>Lisans bilgileriniz e-posta ile gÃ¶nderildi</h3>
            <p>
              Plan detaylarÄ±nÄ±z ve aktivasyon anahtarÄ±nÄ±z birkaÃ§ dakika iÃ§inde
              <strong>{{ companyForm.get('email')?.value || 'firmaya ait e-posta adresine' }}</strong>
              ulaÅŸtÄ±rÄ±lacaktÄ±r.
            </p>
          </div>
        </div>

        <div id="onboarding-guide" class="success-features">
          <h3>SÄ±radaki adÄ±mlar</h3>
          <ul>
            <li>â€¢ Gelen kutunuzu kontrol edin ve lisans e-postasÄ±nÄ± gÃ¼venli bir yerde saklayÄ±n.</li>
            <li>â€¢ De'Bakiim yÃ¶netim paneline giriÅŸ yaparak kullanÄ±cÄ± rollerini tanÄ±mlayÄ±n.</li>
            <li>â€¢ Cihaz aktivasyonlarÄ± iÃ§in e-postadaki talimatlarÄ± takip edin.</li>
            <li>â€¢ Destek ihtiyacÄ±nÄ±z olursa <strong>destek@debakiim.com</strong> ekibimizle iletiÅŸime geÃ§in.</li>
          </ul>
        </div>
      </section>
    }
  </main>

  <section class="cta-banner">
    <div class="cta-content">
      <h2>De'Bakiim ile sesli sipariÅŸ kÃ¼ltÃ¼rÃ¼nÃ¼ baÅŸlatÄ±n</h2>
      <p>PlanÄ±nÄ±zÄ± seÃ§in, firmanÄ±zÄ± oluÅŸturun ve birkaÃ§ dakika iÃ§inde ilk lisans anahtarÄ±nÄ±zÄ± alÄ±n.</p>
    </div>
    <a class="primary-button" href="#plans">
      <i>âœ¨</i> Åimdi BaÅŸlayÄ±n
    </a>
  </section>

  <footer class="page-footer">
    <div class="footer-main">
      <div class="footer-brand">
        <strong>De'Bakiim</strong>
        <span>Â© {{ currentYear }} Hosteagle Information Technologies</span>
      </div>
      <nav class="footer-links">
        <a routerLink="/hakkimizda">HakkÄ±mÄ±zda</a>
        <a routerLink="/teslimat-ve-iade">Teslimat ve Ä°ade ÅartlarÄ±</a>
        <a routerLink="/gizlilik-sozlesmesi">Gizlilik SÃ¶zleÅŸmesi</a>
        <a routerLink="/mesafeli-satis-sozlesmesi">Mesafeli SatÄ±ÅŸ SÃ¶zleÅŸmesi</a>
      </nav>
      <div class="footer-contact">
        <a href="mailto:destek@bisoyle.com">destek@bisoyle.com</a>
        <a href="tel:+902120000000">+90 212 000 00 00</a>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-security">
        <div class="ssl-badge">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1ZM12 7C13.4 7 14.8 8.6 14.8 10V11H16V17H8V11H9.2V10C9.2 8.6 10.6 7 12 7ZM12 8.2C11.2 8.2 10.4 8.7 10.4 10V11H13.6V10C13.6 8.7 12.8 8.2 12 8.2Z" fill="currentColor"/>
          </svg>
          <span>SSL GÃ¼venli</span>
        </div>
      </div>
      <div class="footer-payment-logos">
        <div class="payment-brands">
          <img src="assets/images/visa-logo.svg" alt="Visa" class="payment-logo" onerror="this.style.display='none'">
          <img src="assets/images/mastercard-logo.svg" alt="MasterCard" class="payment-logo" onerror="this.style.display='none'">
        </div>
        <div class="iyzico-logo">
          <img src="assets/images/iyzico-logo.svg" alt="iyzico ile Ã–de" class="iyzico-logo-img" onerror="this.style.display='none'">
        </div>
      </div>
    </div>
  </footer>
</div>
